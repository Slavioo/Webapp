import os
from PyPDF2 import PdfReader
import csv

# Function to search for a keyword in a single PDF and return the count
def search_keyword_in_pdf(pdf_path, keyword):
    with open(pdf_path, 'rb') as file:
        reader = PdfReader(file)
        text = ""
        for page in reader.pages:
            text += page.extract_text()
        return text.lower().count(keyword.lower())

# Main script
if __name__ == "__main__":
    keyword = input("Enter the keyword to search: ")
    pdf_folder = 'PDF'
    summary = []

    # Search for the keyword in each PDF file
    for filename in os.listdir(pdf_folder):
        if filename.endswith('.pdf'):
            pdf_path = os.path.join(pdf_folder, filename)
            count = search_keyword_in_pdf(pdf_path, keyword)
            summary.append([filename, count])

    # Write the summary to a CSV file
    with open('summary.csv', 'w', newline='', encoding='utf-8') as file:
        writer = csv.writer(file)
        writer.writerow(['PDF Name', 'Keyword Occurrence'])
        writer.writerows(summary)

    print("The summary has been saved to summary.csv.")
